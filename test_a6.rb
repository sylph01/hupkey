test({
  kem_curve: :p_521,
  kem_hash: :sha512,
  kdf_hash: :sha512,
  aead_cipher: :aes_256_gcm,
  mode: MODE_BASE,
  info: '4f6465206f6e2061204772656369616e2055726e',
  skem: '014784c692da35df6ecde98ee43ac425dbdd0969c0c72b42f2e708ab9d535415a8569bdacfcc0a114c85b8e3f26acf4d68115f8c91a66178cdbd03b7bcc5291e374b',
  pkrm: '0401b45498c1714e2dce167d3caf162e45e0642afc7ed435df7902ccae0e84ba0f7d373f646b7738bbbdca11ed91bdeae3cdcba3301f2457be452f271fa6837580e661012af49583a62e48d44bed350c7118c0d8dc861c238c72a2bda17f64704f464b57338e7f40b60959480c0e58e6559b190d81663ed816e523b6b6a418f66d2451ec64',
  skrm: '01462680369ae375e4b3791070a7458ed527842f6a98a79ff5e0d4cbde83c27196a3916956655523a6a2556a7af62c5cadabe2ef9da3760bb21e005202f7b2462847',
  psk: '',
  psk_id: '',
  shared_secret: '776ab421302f6eff7d7cb5cb1adaea0cd50872c71c2d63c30c4f1d5e43653336fef33b103c67e7a98add2d3b66e2fda95b5b2a667aa9dac7e59cc1d46d30e818',
  key: '751e346ce8f0ddb2305c8a2a85c70d5cf559c53093656be636b9406d4d7d1b70',
  base_nonce: '55ff7a7d739c69f44b25447b',
  exporter_secret: 'e4ff9dfbc732a2b9c75823763c5ccc954a2c0648fc6de80a58581252d0ee3215388a4455e69086b50b87eb28c169a52f42e71de4ca61c920e7bd24c95cc3f992',
  enc_vecs: {
    0 => {
      pt: '4265617574792069732074727574682c20747275746820626561757479',
      aad: '436f756e742d30',
      nonce: '55ff7a7d739c69f44b25447b',
      ct: '170f8beddfe949b75ef9c387e201baf4132fa7374593dfafa90768788b7b2b200aafcc6d80ea4c795a7c5b841a'
    },
    1 => {
      pt: '4265617574792069732074727574682c20747275746820626561757479',
      aad: '436f756e742d31',
      nonce: '55ff7a7d739c69f44b25447a',
      ct: 'd9ee248e220ca24ac00bbbe7e221a832e4f7fa64c4fbab3945b6f3af0c5ecd5e16815b328be4954a05fd352256'
    },
    2 => {
      pt: '4265617574792069732074727574682c20747275746820626561757479',
      aad: '436f756e742d32',
      nonce: '55ff7a7d739c69f44b254479',
      ct: '142cf1e02d1f58d9285f2af7dcfa44f7c3f2d15c73d460c48c6e0e506a3144bae35284e7e221105b61d24e1c7a'
    },
    255 => {
      pt: '4265617574792069732074727574682c20747275746820626561757479',
      aad: '436f756e742d323535',
      nonce: '55ff7a7d739c69f44b254484',
      ct: '4f268d0930f8d50b8fd9d0f26657ba25b5cb08b308c92e33382f369c768b558e113ac95a4c70dd60909ad1adc7'
    }
  },
  max_seq: 256
})

test({
  kem_curve: :p_521,
  kem_hash: :sha512,
  kdf_hash: :sha512,
  aead_cipher: :aes_256_gcm,
  mode: MODE_PSK,
  info: '4f6465206f6e2061204772656369616e2055726e',
  skem: '012e5cfe0daf5fe2a1cd617f4c4bae7c86f1f527b3207f115e262a98cc65268ec88cb8645aec73b7aa0a472d0292502d1078e762646e0c093cf873243d12c39915f6',
  pkrm: '04006917e049a2be7e1482759fb067ddb94e9c4f7f5976f655088dec45246614ff924ed3b385fc2986c0ecc39d14f907bf837d7306aada59dd5889086125ecd038ead400603394b5d81f89ebfd556a898cc1d6a027e143d199d3db845cb91c5289fb26c5ff80832935b0e8dd08d37c6185a6f77683347e472d1edb6daa6bd7652fea628fae',
  skrm: '011bafd9c7a52e3e71afbdab0d2f31b03d998a0dc875dd7555c63560e142bde264428de03379863b4ec6138f813fa009927dc5d15f62314c56d4e7ff2b485753eb72',
  psk: '0247fd33b913760fa1fa51e1892d9f307fbe65eb171e8132c2af18555a738b82',
  psk_id: '456e6e796e20447572696e206172616e204d6f726961',
  shared_secret: '0d52de997fdaa4797720e8b1bebd3df3d03c4cf38cc8c1398168d36c3fc7626428c9c254dd3f9274450909c64a5b3acbe45e2d850a2fd69ac0605fe5c8a057a5',
  key: 'f764a5a4b17e5d1ffba6e699d65560497ebaea6eb0b0d9010a6d979e298a39ff',
  base_nonce: '479afdf3546ddba3a9841f38',
  exporter_secret: '5c3d4b65a13570502b93095ef196c42c8211a4a188c4590d35863665c705bb140ecba6ce9256be3fad35b4378d41643867454612adfd0542a684b61799bf293f',
  enc_vecs: {
    0 => {
      pt: '4265617574792069732074727574682c20747275746820626561757479',
      aad: '436f756e742d30',
      nonce: '479afdf3546ddba3a9841f38',
      ct: 'de69e9d943a5d0b70be3359a19f317bd9aca4a2ebb4332a39bcdfc97d5fe62f3a77702f4822c3be531aa7843a1'
    },
    1 => {
      pt: '4265617574792069732074727574682c20747275746820626561757479',
      aad: '436f756e742d31',
      nonce: '479afdf3546ddba3a9841f39',
      ct: '77a16162831f90de350fea9152cfc685ecfa10acb4f7994f41aed43fa5431f2382d078ec88baec53943984553e'
    },
    2 => {
      pt: '4265617574792069732074727574682c20747275746820626561757479',
      aad: '436f756e742d32',
      nonce: '479afdf3546ddba3a9841f3a',
      ct: 'f1d48d09f126b9003b4c7d3fe6779c7c92173188a2bb7465ba43d899a6398a333914d2bb19fd769d53f3ec7336'
    },
    255 => {
      pt: '4265617574792069732074727574682c20747275746820626561757479',
      aad: '436f756e742d323535',
      nonce: '479afdf3546ddba3a9841fc7',
      ct: 'a3ee291e20f37021e82df14d41f3fbe98b27c43b318a36cacd8471a3b1051ab12ee055b62ded95b72a63199a3f'
    }
  },
  max_seq: 256
})

test({
  kem_curve: :p_521,
  kem_hash: :sha512,
  kdf_hash: :sha512,
  aead_cipher: :aes_256_gcm,
  mode: MODE_AUTH,
  info: '4f6465206f6e2061204772656369616e2055726e',
  skem: '0185f03560de87bb2c543ef03607f3c33ac09980000de25eabe3b224312946330d2e65d192d3b4aa46ca92fc5ca50736b624402d95f6a80dc04d1f10ae9517137261',
  pkrm: '04007d419b8834e7513d0e7cc66424a136ec5e11395ab353da324e3586673ee73d53ab34f30a0b42a92d054d0db321b80f6217e655e304f72793767c4231785c4a4a6e008f31b93b7a4f2b8cd12e5fe5a0523dc71353c66cbdad51c86b9e0bdfcd9a45698f2dab1809ab1b0f88f54227232c858accc44d9a8d41775ac026341564a2d749f4',
  skrm: '013ef326940998544a899e15e1726548ff43bbdb23a8587aa3bef9d1b857338d87287df5667037b519d6a14661e9503cfc95a154d93566d8c84e95ce93ad05293a0b',
  pksm: '04015cc3636632ea9a3879e43240beae5d15a44fba819282fac26a19c989fafdd0f330b8521dff7dc393101b018c1e65b07be9f5fc9a28a1f450d6a541ee0d76221133001e8f0f6a05ab79f9b9bb9ccce142a453d59c5abebb5674839d935a3ca1a3fbc328539a60b3bc3c05fed22838584a726b9c176796cad0169ba4093332cbd2dc3a9f',
  sksm: '001018584599625ff9953b9305849850d5e34bd789d4b81101139662fbea8b6508ddb9d019b0d692e737f66beae3f1f783e744202aaf6fea01506c27287e359fe776',
  psk: '',
  psk_id: '',
  shared_secret: '26648fa2a2deb0bfc56349a590fd4cb7108a51797b634694fc02061e8d91b3576ac736a68bf848fe2a58dfb1956d266e68209a4d631e513badf8f4dcfc00f30a',
  key: '01fced239845e53f0ec616e71777883a1f9fcab22a50f701bdeee17ad040e44d',
  base_nonce: '9752b85fe8c73eda183f9e80',
  exporter_secret: '80466a9d9cc5112ddad297e817e038801e15fa18152bc4dc010a35d7f534089c87c98b4bacd7bbc6276c4002a74085adcd9019fca6139826b5292569cfb7fe47',
  enc_vecs: {
    0 => {
      pt: '4265617574792069732074727574682c20747275746820626561757479',
      aad: '436f756e742d30',
      nonce: '9752b85fe8c73eda183f9e80',
      ct: '0116aeb3a1c405c61b1ce47600b7ecd11d89b9c08c408b7e2d1e00a4d64696d12e6881dc61688209a8207427f9'
    },
    1 => {
      pt: '4265617574792069732074727574682c20747275746820626561757479',
      aad: '436f756e742d31',
      nonce: '9752b85fe8c73eda183f9e81',
      ct: '37ece0cf6741f443e9d73b9966dc0b228499bb21fbf313948327231e70a18380e080529c0267f399ba7c539cc6'
    },
    2 => {
      pt: '4265617574792069732074727574682c20747275746820626561757479',
      aad: '436f756e742d32',
      nonce: '9752b85fe8c73eda183f9e82',
      ct: 'd17b045cac963e45d55fd3692ec17f100df66ac06d91f3b6af8efa7ed3c8895550eb753bc801fe4bd27005b4bd'
    },
    255 => {
      pt: '4265617574792069732074727574682c20747275746820626561757479',
      aad: '436f756e742d323535',
      nonce: '9752b85fe8c73eda183f9e7f',
      ct: '53d422295a6ce8fcc51e6f69e252e7195e64abf49252f347d8c25534f1865a6a17d949c65ce618ddc7d816111f'
    }
  },
  max_seq: 256
})

test({
  kem_curve: :p_521,
  kem_hash: :sha512,
  kdf_hash: :sha512,
  aead_cipher: :aes_256_gcm,
  mode: MODE_AUTH_PSK,
  info: '4f6465206f6e2061204772656369616e2055726e',
  skem: '003430af19716084efeced1241bb1a5625b6c826f11ef31649095eb27952619e36f62a79ea28001ac452fb20ddfbb66e62c6c0b1be03c0d28c97794a1fb638207a83',
  pkrm: '0401655b5d3b7cfafaba30851d25edc44c6dd17d99410efbed8591303b4dbeea8cb1045d5255f9a60384c3bbd4a3386ae6e6fab341dc1f8db0eed5f0ab1aaac6d7838e00dadf8a1c2c64b48f89c633721e88369e54104b31368f26e35d04a442b0b428510fb23caada686add16492f333b0f7ba74c391d779b788df2c38d7a7f4778009d91',
  skrm: '0053c0bc8c1db4e9e5c3e3158bfdd7fc716aef12db13c8515adf821dd692ba3ca53041029128ee19c8556e345c4bcb840bb7fd789f97fe10f17f0e2c6c2528072843',
  pksm: '040013761e97007293d57de70962876b4926f69a52680b4714bee1d4236aa96c19b840c57e80b14e91258f0a350e3f7ba59f3f091633aede4c7ec4fa8918323aa45d5901076dec8eeb22899fda9ab9e1960003ff0535f53c02c40f2ae4cdc6070a3870b85b4bdd0bb77f1f889e7ee51f465a308f08c666ad3407f75dc046b2ff5a24dbe2ed',
  sksm: '003f64675fc8914ec9e2b3ecf13585b26dbaf3d5d805042ba487a5070b8c5ac1d39b17e2161771cc1b4d0a3ba6e866f4ea4808684b56af2a49b5e5111146d45d9326',
  psk: '0247fd33b913760fa1fa51e1892d9f307fbe65eb171e8132c2af18555a738b82',
  psk_id: '456e6e796e20447572696e206172616e204d6f726961',
  shared_secret: '9e1d5f62cb38229f57f68948a0fbc1264499910cce50ec62cb24188c5b0a98868f3c1cfa8c5baa97b3f24db3cdd30df6e04eae83dc4347be8a981066c3b5b945',
  key: '1316ed34bd52374854ed0e5cb0394ca0a79b2d8ce7f15d5104f21acdfb594286',
  base_nonce: 'd9c64ec8deb8a0647fafe8ff',
  exporter_secret: '6cb00ff99aebb2e4a05042ce0d048326dd2c03acd61a601b1038a65398406a96ab8b5da3187412b2324089ea16ba4ff7e6f4fe55d281fc8ae5f2049032b69ebd',
  enc_vecs: {
    0 => {
      pt: '4265617574792069732074727574682c20747275746820626561757479',
      aad: '436f756e742d30',
      nonce: 'd9c64ec8deb8a0647fafe8ff',
      ct: '942a2a92e0817cf032ce61abccf4f3a7c5d21b794ed943227e07b7df2d6dd92c9b8a9371949e65cca262448ab7'
    },
    1 => {
      pt: '4265617574792069732074727574682c20747275746820626561757479',
      aad: '436f756e742d31',
      nonce: 'd9c64ec8deb8a0647fafe8fe',
      ct: 'c0a83b5ec3d7933a090f681717290337b4fede5bfaa0a40ec29f93acad742888a1513c649104c391c78d1d7f29'
    },
    2 => {
      pt: '4265617574792069732074727574682c20747275746820626561757479',
      aad: '436f756e742d32',
      nonce: 'd9c64ec8deb8a0647fafe8fd',
      ct: '2847b2e0ce0b9da8fca7b0e81ff389d1682ee1b388ed09579b145058b5af6a93a85dd50d9f417dc88f2c785312'
    },
    255 => {
      pt: '4265617574792069732074727574682c20747275746820626561757479',
      aad: '436f756e742d323535',
      nonce: 'd9c64ec8deb8a0647fafe800',
      ct: '63113a870131b567db8f39a11b4541eafbd2d3cf3a9bf9e5c1cfcb41e52f9027310b82a4868215959131694d15'
    }
  },
  max_seq: 256
})